<lib-page-content
  [title]="'attributeDefinition.TaxList' | translate"
  [subTitle]="'attributeDefinitionTaxList' | translate"
>
  <div class="bank">
    <div class="card_micro">
      <div [formGroup]="attrFormGroup" class="entry_header">
        <div class="grid">
          <div class="col-12 md:col-4">
            <lib-form-group>
              <lib-label [appControl]="attrFormGroup.controls['id']" class="body_b14 mb-2 ms-4">
                {{ 'attributeDefinition.attributeId' | translate }}
              </lib-label>
              <lib-text-input
                placeholder="{{ 'attributeDefinition.attributeId' | translate }}"
                formControlName="id"
                [readOnly]="true"
              ></lib-text-input>
            </lib-form-group>
          </div>
          <!--  -->
          <div class="col-12 md:col-4">
            <lib-form-group>
              <lib-label [appControl]="attrFormGroup.controls['nameAr']" class="body_b14 mb-2 ms-4">
                {{ 'attributeDefinition.attributeNameAr' | translate }}
              </lib-label>
              <lib-text-input
                placeholder="{{ 'attributeDefinition.attributeNameAr' | translate }}"
                formControlName="nameAr"
              ></lib-text-input>
            </lib-form-group>
          </div>
          <div class="col-12 md:col-4">
            <lib-form-group>
              <lib-label [appControl]="attrFormGroup.controls['nameEn']" class="body_b14 mb-2 ms-4">
                {{ 'attributeDefinition.attributeNameEn' | translate }}
              </lib-label>
              <lib-text-input
                placeholder="{{ 'attributeDefinition.attributeNameEn' | translate }}"
                formControlName="nameEn"
              ></lib-text-input>
            </lib-form-group>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="entry_table">
    <div class="card">
      <p-table
        [value]="attrTableForm.controls"
        dataKey="id"
        styleClass="p-datatable-gridlines p-datatable-striped"
        [tableStyle]="{ 'min-width': '50rem' }"
      >
        <ng-template pTemplate="header">
          <tr>
            <th>{{ 'attributeDefinition.valueEn' | translate }}</th>
            <th>{{ 'attributeDefinition.valueAr' | translate }}</th>
            <th>{{ 'attributeDefinition.status' | translate }}</th>
            <th>{{ 'attributeDefinition.actions' | translate }}</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-attrTableForm let-i="rowIndex">
  <tr 
    [formGroup]="attrTableForm" 
    [ngClass]="{'duplicate-row': attrTableForm?.controls['isDuplicate']?.value}"
  >
  
    <!-- Name in Arabic -->
    <td [pEditableColumn]="attrTableForm?.controls['nameAr']" pEditableColumnField="nameAr">
      <p-cellEditor>
        <ng-template pTemplate="input">
          <lib-text-input
            placeholder="{{ 'attributeDefinition.valueAr' | translate }}"
            formControlName="nameAr"
          ></lib-text-input>
        </ng-template>
        <ng-template pTemplate="output">
          {{ attrTableForm?.controls['nameAr']?.value }}
        </ng-template>
      </p-cellEditor>
      <lib-field-validations
        [appControl]="attrTableForm?.controls['nameAr']"
      ></lib-field-validations>
    </td>
    <!-- Name in English -->
    <td [pEditableColumn]="attrTableForm?.controls['nameEn']" pEditableColumnField="nameEn">
      <p-cellEditor>
        <ng-template pTemplate="input">
          <lib-text-input
            placeholder="{{ 'attributeDefinition.valueEn' | translate }}"
            formControlName="nameEn"
          ></lib-text-input>
        </ng-template>
        <ng-template pTemplate="output">
          {{ attrTableForm?.controls['nameEn']?.value}}
        </ng-template>
      </p-cellEditor>
      <lib-field-validations
        [appControl]="attrTableForm?.controls['nameEn']"
      ></lib-field-validations>
    </td>
    <td>
      <div class="flex align-items-center">
        <lib-input-switch [id]="i" [disabled]="false" formControlName="isActive"></lib-input-switch>
      </div>
    </td>
    <td>
      <div class="actions flex align-items-center">
        <lib-button-micro
          nameClass="cancel"
          iconName="pi pi-trash"
          type="button"
          (click)="deleteLine(i)"
        ></lib-button-micro>
      </div>
    </td>
  </tr>
</ng-template>

      </p-table>
      <div class="add_new">
        <div class="grid">
          <div class="md:col-3">
            <div class="grid">
              <div class="md:col-6">
                <lib-button-micro
                  nameClass="outline"
                  widthNumber="100%"
                  title="{{ 'attributeDefinition.add_new_value' | translate }}"
                  (click)="addLine()"
                >
                </lib-button-micro>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!--  -->
  <div class="btn_group">
    <div class="grid">
      <div class="md:col-3">
        <div class="grid">
          <div class="md:col-6">
            <lib-button-micro
              title="{{ 'Cancel' | translate }}"
              nameClass="cancel"
              widthNumber="100%"
              (click)="discard()"
            >
            </lib-button-micro>
          </div>
          <div class="md:col-6">
            <div>
              <lib-button-micro
                title="{{ 'Save' | translate }}"
                nameClass="save"
                widthNumber="100%"
                (click)="onSave()"
              >
              </lib-button-micro>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</lib-page-content>
